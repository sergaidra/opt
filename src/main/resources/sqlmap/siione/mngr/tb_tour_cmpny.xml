<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="mngr">
    <typeAlias alias="hashMap" type="java.util.HashMap"/>
    <typeAlias alias="string" type="java.lang.String"/>

    <resultMap id="rmTourCmpny" class="hashMap">
        <result property="CMPNY_CODE" column="CMPNY_CODE" jdbcType="string" javaType="string"/>
        <result property="CMPNY_NM" column="CMPNY_NM" jdbcType="string" javaType="string"/>
        <result property="CMPNY_INTRCN" column="CMPNY_INTRCN" jdbcType="CLOB" javaType="string" />
        <result property="ADRES" column="ADRES" jdbcType="string" javaType="string"/>
        <result property="TELNO" column="TELNO" jdbcType="string" javaType="string"/>
        <result property="DELETE_AT" column="DELETE_AT" jdbcType="string" javaType="string"/>
        <result property="WRITNG_ID" column="WRITNG_ID" jdbcType="string" javaType="string"/>
        <result property="WRITNG_DE" column="WRITNG_DE" jdbcType="string" javaType="string"/>
        <result property="RN" column="RN" jdbcType="string" javaType="string"/>
        <result property="TOT_CNT" column="TOT_CNT" jdbcType="string" javaType="string"/>
    </resultMap>

    <insert id="TourCmpnyDAO.insertTourCmpny" parameterClass="hashMap">
    <![CDATA[
        INSERT INTO TB_TOUR_CMPNY( CMPNY_CODE
                                 , CMPNY_NM
                                 , CMPNY_INTRCN
                                 , ADRES
                                 , TELNO
                                 , DELETE_AT
                                 , WRITNG_ID
                                 , WRITNG_DE )
                           VALUES( LPAD(SQ_CMPNY_CODE.NEXTVAL, 10, '0')
                                 , #CMPNY_NM#
                                 , #CMPNY_INTRCN:CLOB#
                                 , #ADRES#
                                 , #TELNO#
                                 , 'N'
                                 , #WRITNG_ID#
                                 , TO_CHAR(SYSDATE, 'YYYYMMDD'))
    ]]>
    </insert>

    <update id="TourCmpnyDAO.updateTourCmpny" parameterClass="hashMap">
    <![CDATA[
        UPDATE TB_TOUR_CMPNY
           SET CMPNY_NM = #CMPNY_NM#
             , CMPNY_INTRCN = #CMPNY_INTRCN:CLOB#
             , ADRES = #ADRES#
             , TELNO = #TELNO#
             , UPDT_ID = #UPDT_ID#
             , UPDT_DE = TO_CHAR(SYSDATE, 'YYYYMMDD')
         WHERE CMPNY_CODE = #CMPNY_CODE#
    ]]>
    </update>

    <delete id="TourCmpnyDAO.deleteTourCmpny" parameterClass="hashMap">
    <![CDATA[
        UPDATE TB_TOUR_CMPNY
           SET DELETE_AT = 'Y'
             , UPDT_ID = #UPDT_ID#
             , UPDT_DE = TO_CHAR(SYSDATE, 'YYYYMMDD')
         WHERE CMPNY_CODE = #CMPNY_CODE#
    ]]>
    </delete>

    <select id="TourCmpnyDAO.selectTourCmpnyByPk" parameterClass="hashMap" resultMap="rmTourCmpny">
    <![CDATA[
        SELECT CMPNY_CODE
             , CMPNY_NM
             , CMPNY_INTRCN
             , ADRES
             , TELNO
             , DELETE_AT
             , WRITNG_ID
             , WRITNG_DE
             , ROWNUM AS RN
             , COUNT(1) OVER() AS TOT_CNT
          FROM TB_TOUR_CMPNY
         WHERE CMPNY_CODE = #CMPNY_CODE#
    ]]>
    </select>

    <sql id="TourCmpny.sqlPagePre">
        SELECT T2.*
          FROM (SELECT T1.*
                     , ROWNUM AS RN
                     , COUNT(1) OVER() AS TOT_CNT
                  FROM (
        </sql>

        <sql id="TourCmpny.sqlPagePost">
                       ) T1
               ) T2
           WHERE (RN <![CDATA[ > ]]> #startRow# AND RN <![CDATA[ <= ]]> #endRow#)
           ORDER BY RN
    </sql>

    <select id="TourCmpnyDAO.selectTourCmpnyList" parameterClass="hashMap" resultMap="rmTourCmpny">
    <include refid="TourCmpny.sqlPagePre"/>
    <![CDATA[
        SELECT CMPNY_CODE
             , CMPNY_NM
             , CMPNY_INTRCN
             , ADRES
             , TELNO
             , DELETE_AT
             , WRITNG_ID
             , WRITNG_DE
          FROM TB_TOUR_CMPNY
         WHERE 1 = 1
    ]]>
        <isNotEmpty property='SCH_DELETE_AT'>
           AND DELETE_AT = #SCH_DELETE_AT#
        </isNotEmpty>
        <isNotEmpty property='SCH_CMPNY_NM'>
           AND CMPNY_NM LIKE #SCH_CMPNY_NM#||'%'
        </isNotEmpty>
         ORDER BY WRITNG_DE, CMPNY_CODE
    <include refid="TourCmpny.sqlPagePost"/>
    </select>


</sqlMap>